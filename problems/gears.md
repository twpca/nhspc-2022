# 齒輪組 (gears)

## 問題描述

J老師開了一門和機器人相關的熱門選修課。
其中一個作業，是要設計一個齒輪組，用一連串的齒輪互相連接。
第一個齒輪以馬達驅動並以特定轉速轉動，目標是使最後一個齒輪輸出的轉速在一個合理範圍內，而且旋轉方向正確，這樣機器人就能以適當的速度和正確的方向移動。
任兩個相鄰的齒輪有兩種連接方式：

1. 接合：兩個齒輪齒對齒接在一起。前一個齒輪每轉一齒，會使下一個齒輪往相反的方向轉一齒。
2. 帶動：兩個齒輪共用一個軸。前一個齒輪每轉一圈，會使下一個齒輪往相同的方向轉一圈。

教室中有不同齒數的齒輪，其齒數剛巧為 $2$ 的冪次 (如 $8$，$16$，$32$ 等) 和 $3$ 的冪次 (如 $9$，$27$，$81$ 等)。
由於有不同的選擇所以每位學生做出的齒輪組長得不盡相同。請幫忙這位老師快速判斷一個齒輪組最後輸出的轉速與轉動方向，好讓他進行評分。
舉例來說，現在有一個齒輪組，包含四個齒輪，齒數依序是 $9$、$8$、$32$、$16$，
且齒輪之間的連接方式依序是接合、帶動、接合。
教室的第一個齒輪固定以馬達驅動，每分鐘順時針轉 $1$ 圈。第一個齒輪和第二個齒輪接合在一起，
因此第一個齒輪每順時針轉一圈，第二個齒輪會逆時針轉 $1.125$ 圈。
第二個齒輪帶動第三個齒輪，因此第三個齒輪也是每分鐘逆時針轉 $1.125$ 圈。
第三個齒輪和第四個齒輪接合在一起，因此第三個齒輪每逆時針轉一圈，第四個齒輪會順時針轉 $2$ 圈，也就是每分鐘順時針轉 $2.25$ 圈。
最後輸出的轉速是每分鐘順時針轉 $2.25$ 圈。

## 輸入格式

\begin{format}
\f{
$n$
$b_1$ $e_1$ $b_2$ $e_2$ $\cdots$ $b_n$ $e_n$
$c_1$ $c_2$ $\cdots$ $c_{n-1}$
}
\end{format}

* 第 $i$ 個齒輪齒數為 $b_i$ 的 $e_i$ 次方
* $c_i = 1$ 代表第 $i$ 和第 $i+1$ 個齒輪為接合，若 $c_i = 2$ 代表為帶動。

## 輸出格式

\begin{format}
\f{
$f$ $g$ $h$
}
\end{format}

* $f$ 為整數，若 $f=1$ 代表最後一個齒輪順時針轉動，若 $f=-1$ 代表最後一個齒輪逆時針轉動。
* $g$，$h$ 為兩整數，代表最後一個齒輪每一分鐘轉 $2^g3^h$ 圈。

## 測資限制

* $2 \le n \le 20$
* $2 \le b_i \le 3$
* $2 \le e_i \le 100$
* $1 \le c_i \le 2$
* 對 $i \in \{1, 2, \cdots, n-2\}$，$c_i \neq 2$ 或 $c_{i+1} \neq 2$ （一個軸上不會出現三個齒輪）
* 以上變數皆為整數。


## 範例測試

## 評分說明

本題共有兩組子任務，條件限制如下所示。
每一組可有一或多筆測試資料，該組所有測試資料皆需答對才會獲得該組分數。

|  子任務  |  分數  | 額外輸入限制 |
| :------: | :----: | ------------ |
| 1 | {{score.subtask1}} | $n = 2$ |
| 2 | {{score.subtask2}} | 無額外限制 |
